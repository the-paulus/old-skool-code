Attribute VB_Name = "Module3"
Private Declare Function CombineRgn Lib "gdi32" (ByVal hDestRgn As Long, ByVal hSrcRgn1 As Long, ByVal hSrcRgn2 As Long, ByVal nCombineMode As Long) As Long
Private Declare Function CreateRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal Y1 As Long, ByVal X2 As Long, ByVal Y2 As Long) As Long
Private Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As Long
Private Declare Function GetPixel Lib "gdi32" (ByVal hdc As Long, ByVal X As Long, ByVal Y As Long) As Long
Private Declare Function ReleaseCapture Lib "user32" () As Long
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Private Declare Function SetWindowRgn Lib "user32" (ByVal hwnd As Long, ByVal hRgn As Long, ByVal bRedraw As Boolean) As Long
Private lngRegion As Long

'Begin of Function
Public Function MakeFormTransparent(PictureSource As PictureBox, Optional SetColor As Long) As Long
    'Variable Declaration
    Dim DemLength As Long, DemHeight As Long, DemWidth As Long, Final As Long, Tmp As Long, StartHere As Long, Rows As Long, Cols As Long, Retr As Long
        
    'if the SetColor is less than 1 make SetColor variable to transparent
    If SetColor > 1 Then
        SetColor& = GetPixel(PictureSource.hdc, 0, 0)
    End If
    
    DemHeight& = PictureSource.Height / Screen.TwipsPerPixelY
    DemWidth& = PictureSource.Width / Screen.TwipsPerPixelX
    Final& = CreateRectRgn(0, 0, 0, 0)
    
    'for every pixel it will convert it to transparent
    For Rows& = 0 To DemHeight& - 1     'does this til the very last pixel
        Cols& = 0   'Sets Cols to 0
        
        Do While Cols& < DemWidth&    'loops while Cols is less than DemWidth
            
            'adds 1 to Cols while Cols is less than DemWidth and GetPixel = SetColor
            Do While Cols& < DemWidth& And GetPixel(PictureSource.hdc, Cols&, Rows&) = SetColor&
                Cols& = Cols& + 1
            Loop
            
                If Cols& < DemWidth& Then
                    StartHere& = Cols&
                End If
                Do While Cols& < DemWidth& And GetPixel(PictureSource.hdc, Cols&, Rows&) <> SetColor&
                    Cols& = Cols& + 1
                Loop
        
                If Cols& > DemWidth& Then
                    Cols& = DemWidth&
                    Tmp& = CreateRectRgn(StartHere&, Rows&, Cols&, Rows& + 1)
                    Retr& = CombineRgn(Final&, Final&, Tmp&, 0)
                    DeleteObject (Tmp&) 'Deletes Tmp
                End If
        Loop
        
    Next Rows&
  
  MakeFormTransparent& = Final&

End Function

